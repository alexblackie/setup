---

- name: install zsh
  become: yes
  package:
    name: zsh
    state: present
  when: ansible_facts["os_family"] != "Darwin"

- name: set default shell to zsh
  become: yes
  user:
    name: "{{ local_user }}"
    shell: /usr/bin/zsh
  when: ansible_facts["os_family"] != "Darwin"

- name: Increase default user watches limit
  become: yes
  lineinfile:
    line: "fs.inotify.max_user_watches=524288"
    dest: /etc/sysctl.conf
  when: ansible_facts["os_family"] != "Darwin"

- name: Create directory for third-party software sources
  file:
    path: "{{ third_party_src }}"
    state: directory

- name: Create local bin directory
  file:
    path: "{{ home }}/bin"
    state: directory

- name: Install C toolchain
  become: yes
  zypper:
    type: pattern
    name: devel_basis
    state: present
  when: ansible_facts["os_family"] == "Suse"

- name: Install some development tools and libraries
  become: yes
  package:
    name:
      - gcc-c++
      - ImageMagick
      - ImageMagick-devel
      - autoconf
      - automake
      - git
      - inotify-tools
      - jq
      - libffi-devel
      - libtool
      - libxslt-devel
      - libyaml-devel
      - ncurses-devel
      - nmap
      - openssl-devel
      - optipng
      - tree
      - pwgen
      - readline-devel
      - ruby-devel
      - sqlite-devel
      - postgresql13
      - tmux
      - unixODBC-devel
      - neovim
      - whois
      - wxWidgets
      - wxGTK3-devel
      - ShellCheck
      - entr
      - ripgrep
      - htop
      - perf
      - strace
    state: present
  when: ansible_facts["os_family"] == "Suse"

- name: Install some development tools and libraries
  homebrew:
    name:
      - autoconf
      - curl
      - entr
      - findutils
      - git
      - gnupg
      - htop
      - imagemagick
      - jq
      - nmap
      - optipng
      - pwgen
      - shellcheck
      - sqlite
      - ripgrep
      - tree
      - tmux
      - neovim
      - wget
      - wxmac
      - postgresql
    state: present
  when: ansible_facts["os_family"] == "Darwin"

- import_tasks: redis.yml
- import_tasks: fzy.yml
- import_tasks: asdf.yml
- import_tasks: java.yml
- import_tasks: azure.yml
- import_tasks: fd.yml
- import_tasks: dotfiles.yml
