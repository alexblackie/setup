---

- name: Install ZSH
  become: true
  package:
    name: zsh
    state: present
  when: ansible_facts["os_family"] == "RedHat"

- name: Set default shell to ZSH
  become: true
  user:
    name: "{{ local_user }}"
    shell: /usr/bin/zsh
  when: ansible_facts["os_family"] == "RedHat"

- name: Disable default ls colouring
  become: true
  copy:
    dest: /etc/profile.d/colorls.sh
    content: ""
  when: ansible_facts["os_family"] == "RedHat"

- name: Increase default user watches limit
  become: true
  lineinfile:
    line: "fs.inotify.max_user_watches=524288"
    dest: /etc/sysctl.conf
  when: ansible_facts["os_family"] == "RedHat"

- name: Create directory for third-party software sources
  file:
    path: "{{ third_party_src }}"
    state: directory

- name: Create local bin directory
  file:
    path: "{{ home }}/bin"
    state: directory

- name: Install C toolchain
  become: true
  dnf:
    name: "@C Development Tools and Libraries"
    state: present
  when: ansible_facts["os_family"] == "RedHat"

- name: Install some development tools and libraries
  become: true
  dnf:
    name:
      - ImageMagick
      - ImageMagick-devel
      - autoconf
      - automake
      - git
      - inotify-tools
      - jq
      - libffi-devel
      - libtool
      - libxslt-devel
      - libyaml-devel
      - ncurses-devel
      - nmap
      - openssl-devel
      - optipng
      - pwgen
      - readline-devel
      - ruby-devel
      - sqlite-devel
      - postgresql
      - tmux
      - unixODBC-devel
      - neovim
      - whois
      - wxBase3
      - wxGTK3-devel
      - rclone
      - ShellCheck
      - entr
      - ripgrep
      - htop
      - perf
      - strace
      - exa
    state: present
  when: ansible_facts["os_family"] == "RedHat"

- name: Install some development tools and libraries
  homebrew:
    name:
      - autoconf
      - curl
      - entr
      - findutils
      - git
      - gnupg
      - htop
      - imagemagick
      - jq
      - nmap
      - optipng
      - pwgen
      - shellcheck
      - sqlite
      - ripgrep
      - tmux
      - neovim
      - wget
      - wxmac
      - postgresql
      - rclone
      - exa
    state: present
  when: ansible_facts["os_family"] == "Darwin"

- import_tasks: redis.yml
- import_tasks: fzy.yml
- import_tasks: asdf.yml
- import_tasks: python.yml
- import_tasks: java.yml
- import_tasks: azure.yml
- import_tasks: fd.yml
- import_tasks: dotfiles.yml
